<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <div class="trial-form" id="hubspotform">
        <!--[if lte IE 8]>
    <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
    <![endif]-->
        <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
        <script charset="utf-8" type="text/javascript" src="//js.kintone.com/jquery/3.4.1/jquery.min.js"></script>
        <script>
            var VALIDATE_DOMAIN_URL = 'https://get.kintone.com/api/open/validateSubdomain.json';
            var REDIRECT_URL = 'https://stagingkintone.wpengine.com/thank-you';
            var ORDER_ID_PARAM = "order_id";
            //var F_ID =  "4a5eb5a0-9e25-4d33-8667-268c851a8057" //Regular
            // var F_ID = "1a85a987-3907-4a40-a60d-bde365432658" //NPO
            //var F_ID =  "4a5eb5a0-9e25-4d33-8667-268c851a8057" //Edu/Gov
            var F_ID =  "b6128403-9287-40b6-ba57-21419ee506b6"

            function validateDomain($form) {
                var $domainMessageContainer = $form.find('ul[id="domain-message"]');
                if (!$domainMessageContainer[0]) {
                    $form.find('input[name="domain"]').parent().parent().append('<ul id="domain-message" class="hs-error-msgs inputs-list"></ul>');
                    $domainMessageContainer = $form.find('ul[id="domain-message"]');
                }

                // empty case
                if (!this.value || this.value.length === 0) {
                    $domainMessageContainer.empty();
                    $form.find(':input[type="submit"]').prop('disabled', true);
                    return;
                }

                $.ajax({
                    url: VALIDATE_DOMAIN_URL,
                    type: 'POST',
                    data: JSON.stringify({ subdomain: this.value }),
                    contentType: 'application/json; charset=utf-8'
                })
                    .then(function (response) {
                        if (!response) {
                            return;
                        }
                        $domainMessageContainer.empty();
                        $domainMessageContainer.append('<li><label>Available</label></li>');
                        $form.find(':input[type="submit"]').prop('disabled', false);
                    })
                    .catch(function (error) {
                        if (error.status === 400 && error.responseJSON) {
                            $domainMessageContainer.empty();
                            $form.find(':input[type="submit"]').prop('disabled', true);
                            var response = error.responseJSON;
                            var messages = response.errors.subdomain.messages;
                            if (messages) {
                                $domainMessageContainer.append('<li><label>' + messages.join() + '</label></li>');
                            }
                        }
                    })
            }

            function setup($form) {
                var $submit = $form.find('input[type="submit"]');
                $submit.prop('disabled', true);
                var $domain = $form.find('input[name="domain"]');
                $domain.change(validateDomain.bind($domain.get(0), $form));
                if ($domain.val()) {
                    $domain.trigger("change");
                }
                //  if (YAKUMO_PLANE) {
                //    var $plane = $form.find('input[name="plane"]');
                //    $plane.val(YAKUMO_PLANE);
                //  }
            }

            function getParam(name, url) {
                if (!url) url = window.location.href;
                name = name.replace(/[\[\]]/g, "\\$&");
                var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                    results = regex.exec(url);
                if (!results) return null;
                if (!results[2]) return '';
                return decodeURIComponent(results[2].replace(/\+/g, " "));
            }

            function submit() {
                if (getParam(ORDER_ID_PARAM)) {
                    location.href = REDIRECT_URL + "?" + ORDER_ID_PARAM + "=" + getParam(ORDER_ID_PARAM);
                } else {
                    location.href = REDIRECT_URL;
                }
            }

            ////////
            hbspt.forms.create({
                portalId: "1857320",
                formId: F_ID,
                target: '#hubspotform',
                onFormReady: setup,
                onFormSubmitted: submit
            });
        </script>
        </div>s
    
    
</body>
</html>